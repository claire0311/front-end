{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Paul2\\\\onedrive\\\\\\u684C\\u9762\\\\llm_dialougue_v4\\\\wingchat-app\\\\src\\\\components\\\\TrainingRoom\\\\MessageInput.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { Form, Button, InputGroup, Spinner } from 'react-bootstrap';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction MessageInput({\n  currentMessage,\n  onMessageChange,\n  onSendMessage,\n  onGetFeedback,\n  isLoading,\n  isGettingFeedback,\n  // 接收回饋讀取狀態\n  disabled\n}) {\n  _s();\n  const textareaRef = useRef(null);\n\n  // 自動調整 Textarea 高度\n  useEffect(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto'; // Reset height\n      textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`; // Set to scroll height\n    }\n  }, [currentMessage]); // 當訊息內容改變時調整\n\n  const handleKeyDown = e => {\n    // Shift+Enter 換行，單獨 Enter 發送 (如果不在載入中且未禁用)\n    if (e.key === 'Enter' && !e.shiftKey && !isLoading && !isGettingFeedback && !disabled && currentMessage.trim()) {\n      e.preventDefault(); // 防止 Enter 預設行為 (換行或提交表單)\n      onSendMessage();\n    }\n  };\n  const handleSendClick = () => {\n    if (!isLoading && !isGettingFeedback && !disabled && currentMessage.trim()) {\n      onSendMessage();\n    }\n  };\n  const handleFeedbackClick = () => {\n    if (!isLoading && !isGettingFeedback && !disabled) {\n      onGetFeedback();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(InputGroup, {\n    children: [/*#__PURE__*/_jsxDEV(Button, {\n      variant: \"outline-info\",\n      onClick: handleFeedbackClick,\n      disabled: isLoading || isGettingFeedback || disabled,\n      title: \"\\u8B93 AI \\u91DD\\u5C0D\\u672C\\u6B21\\u5C0D\\u8A71\\u7D66\\u51FA\\u56DE\\u994B\",\n      children: isGettingFeedback ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Spinner, {\n          as: \"span\",\n          animation: \"border\",\n          size: \"sm\",\n          role: \"status\",\n          \"aria-hidden\": \"true\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 54,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"visually-hidden\",\n          children: \"\\u8ACB\\u6C42\\u4E2D...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 55,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true) : \"🤔 我說得如何？\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n      ref: textareaRef,\n      as: \"textarea\",\n      rows: 1,\n      placeholder: disabled ? \"請先設定目標並選擇角色...\" : \"輸入訊息 (Shift+Enter 換行)...\",\n      value: currentMessage,\n      onChange: e => onMessageChange(e.target.value),\n      onKeyDown: handleKeyDown,\n      disabled: isLoading || isGettingFeedback || disabled,\n      style: {\n        resize: 'none',\n        overflowY: 'auto',\n        maxHeight: '150px'\n      } // 防止手動調整大小, 超出高度顯示滾動條, 限制最大高度\n      ,\n      \"aria-label\": \"\\u8A0A\\u606F\\u8F38\\u5165\\u6846\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Button, {\n      variant: \"primary\",\n      onClick: handleSendClick,\n      disabled: isLoading || isGettingFeedback || disabled || !currentMessage.trim(),\n      children: isLoading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Spinner, {\n          as: \"span\",\n          animation: \"border\",\n          size: \"sm\",\n          role: \"status\",\n          \"aria-hidden\": \"true\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"visually-hidden\",\n          children: \"\\u50B3\\u9001\\u4E2D...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true) : /*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"bi bi-send\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 14\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n}\n_s(MessageInput, \"gSWexK8idHTRtbhGpJOt6TRUPko=\");\n_c = MessageInput;\nexport default MessageInput;\nvar _c;\n$RefreshReg$(_c, \"MessageInput\");","map":{"version":3,"names":["React","useState","useRef","useEffect","Form","Button","InputGroup","Spinner","jsxDEV","_jsxDEV","Fragment","_Fragment","MessageInput","currentMessage","onMessageChange","onSendMessage","onGetFeedback","isLoading","isGettingFeedback","disabled","_s","textareaRef","current","style","height","scrollHeight","handleKeyDown","e","key","shiftKey","trim","preventDefault","handleSendClick","handleFeedbackClick","children","variant","onClick","title","as","animation","size","role","fileName","_jsxFileName","lineNumber","columnNumber","className","Control","ref","rows","placeholder","value","onChange","target","onKeyDown","resize","overflowY","maxHeight","_c","$RefreshReg$"],"sources":["C:/Users/Paul2/onedrive/桌面/llm_dialougue_v4/wingchat-app/src/components/TrainingRoom/MessageInput.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { Form, Button, InputGroup, Spinner } from 'react-bootstrap';\r\n\r\nfunction MessageInput({\r\n    currentMessage,\r\n    onMessageChange,\r\n    onSendMessage,\r\n    onGetFeedback,\r\n    isLoading,\r\n    isGettingFeedback, // 接收回饋讀取狀態\r\n    disabled\r\n}) {\r\n  const textareaRef = useRef(null);\r\n\r\n  // 自動調整 Textarea 高度\r\n  useEffect(() => {\r\n    if (textareaRef.current) {\r\n      textareaRef.current.style.height = 'auto'; // Reset height\r\n      textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`; // Set to scroll height\r\n    }\r\n  }, [currentMessage]); // 當訊息內容改變時調整\r\n\r\n  const handleKeyDown = (e) => {\r\n    // Shift+Enter 換行，單獨 Enter 發送 (如果不在載入中且未禁用)\r\n    if (e.key === 'Enter' && !e.shiftKey && !isLoading && !isGettingFeedback && !disabled && currentMessage.trim()) {\r\n      e.preventDefault(); // 防止 Enter 預設行為 (換行或提交表單)\r\n      onSendMessage();\r\n    }\r\n  };\r\n\r\n  const handleSendClick = () => {\r\n      if (!isLoading && !isGettingFeedback && !disabled && currentMessage.trim()) {\r\n          onSendMessage();\r\n      }\r\n  }\r\n\r\n  const handleFeedbackClick = () => {\r\n      if (!isLoading && !isGettingFeedback && !disabled) {\r\n          onGetFeedback();\r\n      }\r\n  }\r\n\r\n  return (\r\n    <InputGroup>\r\n      {/* 快速回饋按鈕 */}\r\n      <Button\r\n        variant=\"outline-info\"\r\n        onClick={handleFeedbackClick}\r\n        disabled={isLoading || isGettingFeedback || disabled}\r\n        title=\"讓 AI 針對本次對話給出回饋\"\r\n      >\r\n        {isGettingFeedback ? (\r\n            <>\r\n              <Spinner as=\"span\" animation=\"border\" size=\"sm\" role=\"status\" aria-hidden=\"true\" />\r\n              <span className=\"visually-hidden\">請求中...</span>\r\n            </>\r\n        ) : (\r\n            \"🤔 我說得如何？\"\r\n        )}\r\n      </Button>\r\n\r\n      <Form.Control\r\n        ref={textareaRef}\r\n        as=\"textarea\"\r\n        rows={1}\r\n        placeholder={disabled ? \"請先設定目標並選擇角色...\" : \"輸入訊息 (Shift+Enter 換行)...\"}\r\n        value={currentMessage}\r\n        onChange={(e) => onMessageChange(e.target.value)}\r\n        onKeyDown={handleKeyDown}\r\n        disabled={isLoading || isGettingFeedback || disabled}\r\n        style={{ resize: 'none', overflowY: 'auto', maxHeight: '150px' }} // 防止手動調整大小, 超出高度顯示滾動條, 限制最大高度\r\n        aria-label=\"訊息輸入框\"\r\n      />\r\n\r\n      {/* 語音輸入預留圖示 (未來功能) */}\r\n      {/*\r\n      <Button variant=\"outline-secondary\" disabled={isLoading || isGettingFeedback || disabled} title=\"語音輸入 (尚未啟用)\">\r\n          <i className=\"bi bi-mic\"></i>\r\n      </Button>\r\n      */}\r\n\r\n      <Button\r\n        variant=\"primary\"\r\n        onClick={handleSendClick}\r\n        disabled={isLoading || isGettingFeedback || disabled || !currentMessage.trim()}\r\n      >\r\n        {isLoading ? (\r\n            <>\r\n                <Spinner as=\"span\" animation=\"border\" size=\"sm\" role=\"status\" aria-hidden=\"true\"/>\r\n                <span className=\"visually-hidden\">傳送中...</span>\r\n            </>\r\n        ) : (\r\n             <i className=\"bi bi-send\"></i>\r\n        )}\r\n      </Button>\r\n    </InputGroup>\r\n  );\r\n}\r\n\r\nexport default MessageInput;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}