{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Paul2\\\\Downloads\\\\front-end-main (5)\\\\front-end-main\\\\src\\\\components\\\\TrainingRoom\\\\TrainingRoom.js\",\n  _s = $RefreshSig$();\n// src/components/TrainingRoom/TrainingRoom.js (包含同步刪除回饋、記錄用戶上下文)\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Form, InputGroup, Container, Row, Col, Spinner, Alert, Button, Dropdown } from 'react-bootstrap';\nimport ChatDisplay from './ChatDisplay';\nimport MessageInput from './MessageInput';\nimport { sendMessageToOllama, getFeedbackFromOllama } from '../../services/ollamaService'; // 確保路徑正確\nimport '../../styles/TrainingRoom.css'; // 確保路徑正確\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CHAT_HISTORY_PREFIX = 'wingchat_history_';\nconst FEEDBACK_STORAGE_KEY = 'wingchat_feedback';\nfunction TrainingRoom({\n  characters,\n  selectedCharacter,\n  onSelectCharacter,\n  setActiveView\n}) {\n  _s();\n  const [goal, setGoal] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [currentMessage, setCurrentMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [isGettingFeedback, setIsGettingFeedback] = useState(false);\n  const [error, setError] = useState(null);\n  const currentGoalRef = useRef(goal);\n  const getStorageKey = useCallback(() => {\n    if (!selectedCharacter || !goal.trim()) return null;\n    const goalKey = goal.trim().substring(0, 50).replace(/[^a-zA-Z0-9-_]/g, '_');\n    return `${CHAT_HISTORY_PREFIX}${selectedCharacter.id}_${goalKey}`;\n  }, [selectedCharacter, goal]);\n  useEffect(() => {\n    currentGoalRef.current = goal;\n    const storageKey = getStorageKey();\n    if (storageKey) {\n      const savedHistory = localStorage.getItem(storageKey);\n      if (savedHistory) {\n        try {\n          setMessages(JSON.parse(savedHistory));\n        } catch (e) {\n          console.error(\"Parsing chat history failed\", e);\n          setMessages([]);\n        }\n      } else {\n        setMessages([]);\n      }\n    } else if (selectedCharacter) {\n      setMessages([]);\n    }\n    setError(null);\n  }, [selectedCharacter, goal, getStorageKey]);\n  useEffect(() => {\n    const storageKey = getStorageKey();\n    if (storageKey && messages.length > 0) {\n      localStorage.setItem(storageKey, JSON.stringify(messages));\n    } else if (storageKey && messages.length === 0 && localStorage.getItem(storageKey)) {\n      localStorage.removeItem(storageKey);\n      console.log(`Removed chat history from localStorage on clear: ${storageKey}`);\n    }\n  }, [messages, getStorageKey]);\n\n  // 清除聊天記錄並同步刪除相關回饋\n  const handleClearChat = () => {\n    if (!selectedCharacter || !goal.trim()) return;\n    const characterName = selectedCharacter.name;\n    const currentGoal = goal.trim();\n    const characterId = selectedCharacter.id;\n    if (window.confirm(`確定要清除與 ${characterName} 關於目標「${currentGoal}」的所有聊天記錄嗎？\\n\\n⚠️ 這將同時刪除所有與此對話相關的回饋記錄！`)) {\n      setMessages([]); // 清除狀態，觸發 useEffect 移除聊天記錄\n      try {\n        const savedFeedback = localStorage.getItem(FEEDBACK_STORAGE_KEY);\n        let allFeedback = [];\n        if (savedFeedback) {\n          allFeedback = JSON.parse(savedFeedback);\n          if (!Array.isArray(allFeedback)) allFeedback = [];\n        }\n        const updatedFeedbackHistory = allFeedback.filter(fb => !(fb.characterId === characterId && fb.goal === currentGoal));\n        localStorage.setItem(FEEDBACK_STORAGE_KEY, JSON.stringify(updatedFeedbackHistory));\n        console.log(`Removed ${allFeedback.length - updatedFeedbackHistory.length} feedback records for characterId=${characterId} and goal=${currentGoal}`);\n      } catch (e) {\n        console.error(\"清除相關回饋記錄時出錯:\", e);\n        alert(\"清除相關回饋記錄時發生錯誤。\");\n      }\n    }\n  };\n\n  // 發送訊息\n  const handleSendMessage = async () => {\n    if (!currentMessage.trim() || !selectedCharacter) return;\n    if (!goal.trim()) {\n      setError(\"請先設定本次聊天的目標！\");\n      return;\n    }\n    if (isLoading || isGettingFeedback) return;\n    const newUserMessage = {\n      id: Date.now(),\n      sender: 'user',\n      text: currentMessage\n    };\n    const currentInput = currentMessage;\n    setMessages(prevMessages => [...prevMessages, newUserMessage]);\n    setCurrentMessage('');\n    setIsLoading(true);\n    setError(null);\n    try {\n      const historyForOllama = messages.map(msg => ({\n        role: msg.sender === 'user' ? 'user' : 'assistant',\n        content: msg.text\n      }));\n      const requestHistory = [...historyForOllama, {\n        role: 'user',\n        content: currentInput\n      }];\n      const chatModel = process.env.REACT_APP_OLLAMA_CHAT_MODEL || 'llama3.2:latest';\n      const aiResponseText = await sendMessageToOllama(goal, requestHistory, selectedCharacter, chatModel);\n      const newAiMessage = {\n        id: Date.now() + 1,\n        sender: 'ai',\n        text: aiResponseText\n      };\n      setMessages(prevMessages => [...prevMessages, newAiMessage]);\n    } catch (err) {\n      console.error(\"Error contacting Ollama:\", err);\n      const errorMsg = err.message || \"與 AI 通訊時發生錯誤。\";\n      setError(errorMsg);\n      const errorAiMessage = {\n        id: Date.now() + 1,\n        sender: 'ai',\n        text: `🤖 抱歉，處理時遇到問題：${errorMsg}`\n      };\n      setMessages(prevMessages => [...prevMessages, errorAiMessage]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 回饋解析\n  const parseFeedback = feedbackText => {\n    let summary = \"無法解析回饋摘要。\";\n    let scores = {\n      clarity: null,\n      empathy: null,\n      confidence: null,\n      appropriateness: null,\n      goalAchievement: null\n    };\n    let summaryMatch = null;\n    let summaryOnlyMatch = null;\n    let scoresTextMatch = null;\n    try {\n      summaryMatch = feedbackText.match(/\\[Feedback Summary\\]\\s*([\\s\\S]*?)\\s*\\[Scores\\]/);\n      if (summaryMatch && summaryMatch[1]) {\n        summary = summaryMatch[1].trim();\n      } else {\n        summaryOnlyMatch = feedbackText.match(/\\[Feedback Summary\\]\\s*([\\s\\S]*)/);\n        if (summaryOnlyMatch && summaryOnlyMatch[1]) {\n          summary = summaryOnlyMatch[1].trim();\n          console.warn(\"Only found summary...\");\n        } else {\n          console.warn(\"Could not find [Feedback Summary] section.\");\n          summary = feedbackText;\n        }\n      }\n      scoresTextMatch = feedbackText.match(/\\[Scores\\]\\s*([\\s\\S]*)/);\n      if (scoresTextMatch && scoresTextMatch[1]) {\n        const scoreLines = scoresTextMatch[1].trim().split('\\n');\n        scoreLines.forEach(line => {\n          const parts = line.split(':');\n          if (parts.length === 2) {\n            let key = parts[0].trim().toLowerCase().replace(/\\s+/g, '');\n            if (key === 'goalachievement') key = 'goalAchievement';\n            const value = parts[1].trim();\n            if (Object.prototype.hasOwnProperty.call(scores, key)) {\n              if (value.toLowerCase() === 'n/a') {\n                scores[key] = null;\n              } else {\n                const score = parseInt(value, 10);\n                if (!isNaN(score)) {\n                  scores[key] = Math.max(0, Math.min(100, score));\n                } else {\n                  console.warn(`Invalid score value \"${value}\" for key \"${key}\"`);\n                  scores[key] = null;\n                }\n              }\n            } else {\n              console.warn(`Unexpected score key \"${key}\" found.`);\n            }\n          }\n        });\n      } else if (!summaryOnlyMatch && summaryMatch === null) {\n        console.warn(\"Could not find [Scores] section...\");\n      }\n    } catch (e) {\n      console.error(\"Error parsing feedback text:\", e);\n      summary = feedbackText;\n      scores = {\n        clarity: null,\n        empathy: null,\n        confidence: null,\n        appropriateness: null,\n        goalAchievement: null\n      };\n    }\n    console.log(\"Parsed Feedback:\", {\n      summary,\n      scores\n    });\n    return {\n      summary,\n      scores\n    };\n  };\n\n  // 獲取回饋並記錄上下文\n  const handleGetFeedback = async () => {\n    if (!selectedCharacter || !goal.trim() || messages.filter(m => m.sender === 'user').length === 0) {\n      alert(\"請先設定目標、選擇角色並進行至少一輪對話 (包含你的發言)，才能請求回饋。\");\n      return;\n    }\n    if (isLoading || isGettingFeedback) return;\n    setIsGettingFeedback(true);\n    setError(null);\n    const feedbackRequestMessage = {\n      id: Date.now(),\n      sender: 'system',\n      text: '⏳ 正在向 AI 請求對話回饋...'\n    };\n    setMessages(prevMessages => [...prevMessages, feedbackRequestMessage]);\n    try {\n      var _scores$clarity, _scores$empathy, _scores$confidence, _scores$appropriatene, _scores$goalAchieveme;\n      const historyForFeedback = messages.filter(msg => msg.sender !== 'system').map(msg => ({\n        role: msg.sender === 'user' ? 'user' : 'assistant',\n        content: msg.text\n      }));\n      // --- 獲取用戶訊息上下文 ---\n      const userMessagesForContext = messages.filter(msg => msg.sender === 'user').slice(-3).map(msg => msg.text);\n      const feedbackModel = process.env.REACT_APP_OLLAMA_FEEDBACK_MODEL || process.env.REACT_APP_OLLAMA_CHAT_MODEL || 'llama3.2:latest';\n      const feedbackRawText = await getFeedbackFromOllama(goal, historyForFeedback, selectedCharacter, feedbackModel);\n      const {\n        summary,\n        scores\n      } = parseFeedback(feedbackRawText);\n      // 聊天框中的回饋訊息（不顯示上下文）\n      const feedbackMessage = {\n        id: Date.now() + 1,\n        sender: 'ai',\n        isFeedback: true,\n        text: `💡 **本次對話回饋 (${goal})**\\n\\n**摘要:**\\n${summary}\\n\\n**評分 (0-100):**\\n- 清晰度: ${(_scores$clarity = scores.clarity) !== null && _scores$clarity !== void 0 ? _scores$clarity : 'N/A'}\\n- 同理心: ${(_scores$empathy = scores.empathy) !== null && _scores$empathy !== void 0 ? _scores$empathy : 'N/A'}\\n- 自信: ${(_scores$confidence = scores.confidence) !== null && _scores$confidence !== void 0 ? _scores$confidence : 'N/A'}\\n- 適當性: ${(_scores$appropriatene = scores.appropriateness) !== null && _scores$appropriatene !== void 0 ? _scores$appropriatene : 'N/A'}\\n- 目標達成: ${(_scores$goalAchieveme = scores.goalAchievement) !== null && _scores$goalAchieveme !== void 0 ? _scores$goalAchieveme : 'N/A'}`\n      };\n      // 存儲到 localStorage 的數據（包含上下文）\n      const newFeedbackEntry = {\n        timestamp: Date.now(),\n        goal: goal,\n        characterId: selectedCharacter.id,\n        characterName: selectedCharacter.name,\n        scores: scores,\n        summary: summary,\n        userMessagesContext: userMessagesForContext,\n        rawFeedback: feedbackRawText\n      };\n      const existingFeedback = JSON.parse(localStorage.getItem(FEEDBACK_STORAGE_KEY) || '[]');\n      localStorage.setItem(FEEDBACK_STORAGE_KEY, JSON.stringify([...existingFeedback, newFeedbackEntry]));\n      setMessages(prevMessages => [...prevMessages.filter(msg => msg.id !== feedbackRequestMessage.id), feedbackMessage]);\n    } catch (err) {\n      console.error(\"Error getting or parsing feedback from Ollama:\", err);\n      const errorMsg = err.message || \"無法獲取或處理 AI 回饋。\";\n      setError(errorMsg);\n      const errorFeedbackMessage = {\n        id: Date.now() + 1,\n        sender: 'ai',\n        text: `🤖 抱歉，獲取回饋時遇到問題：${errorMsg}`\n      };\n      setMessages(prevMessages => [...prevMessages.filter(msg => msg.id !== feedbackRequestMessage.id), errorFeedbackMessage]);\n    } finally {\n      setIsGettingFeedback(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    className: \"training-room-container p-0\",\n    children: [/*#__PURE__*/_jsxDEV(Row, {\n      className: \"goal-input-row m-0 align-items-center\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        md: 7,\n        className: \"mb-2 mb-md-0\",\n        children: /*#__PURE__*/_jsxDEV(InputGroup, {\n          children: [/*#__PURE__*/_jsxDEV(InputGroup.Text, {\n            children: \"\\uD83C\\uDFAF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"text\",\n            placeholder: \"\\u8F38\\u5165\\u672C\\u6B21\\u793E\\u4EA4\\u8A13\\u7DF4\\u76EE\\u6A19...\",\n            value: goal,\n            onChange: e => setGoal(e.target.value),\n            disabled: isLoading || isGettingFeedback,\n            \"aria-label\": \"\\u804A\\u5929\\u76EE\\u6A19\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        md: 5,\n        className: \"d-flex align-items-center justify-content-md-end\",\n        children: [characters && characters.length > 0 ? /*#__PURE__*/_jsxDEV(Dropdown, {\n          className: \"me-3\",\n          id: \"character-selector-dropdown\",\n          children: [/*#__PURE__*/_jsxDEV(Dropdown.Toggle, {\n            variant: \"outline-secondary\",\n            size: \"sm\",\n            id: \"dropdown-character-select-button\",\n            disabled: isLoading || isGettingFeedback,\n            style: {\n              minWidth: '120px',\n              textAlign: 'left'\n            },\n            children: [\"\\u8207: \", selectedCharacter ? /*#__PURE__*/_jsxDEV(\"strong\", {\n              className: \"text-primary\",\n              children: selectedCharacter.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 41\n            }, this) : '選擇角色']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Dropdown.Menu, {\n            style: {\n              maxHeight: '300px',\n              overflowY: 'auto'\n            },\n            children: [characters.map(character => /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n              active: (selectedCharacter === null || selectedCharacter === void 0 ? void 0 : selectedCharacter.id) === character.id,\n              onClick: () => onSelectCharacter(character),\n              disabled: (selectedCharacter === null || selectedCharacter === void 0 ? void 0 : selectedCharacter.id) === character.id,\n              children: [\" \", character.name, \" \"]\n            }, character.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 48\n            }, this)), /*#__PURE__*/_jsxDEV(Dropdown.Divider, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 18\n            }, this), /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n              onClick: () => setActiveView && setActiveView('characters'),\n              children: [\" \", /*#__PURE__*/_jsxDEV(\"small\", {\n                className: \"text-muted\",\n                children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-gear me-1\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 90,\n                  columnNumber: 126\n                }, this), \" \\u7BA1\\u7406\\u89D2\\u8272... \"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 90,\n                columnNumber: 95\n              }, this), \" \"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 90,\n              columnNumber: 18\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"text-danger me-3 small\",\n          children: \"\\u8ACB\\u5148\\u81F3\\u89D2\\u8272\\u9928\\u65B0\\u589E\\u89D2\\u8272\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 18\n        }, this), selectedCharacter && goal.trim() && messages.length > 0 && /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outline-danger\",\n          size: \"sm\",\n          onClick: handleClearChat,\n          disabled: isLoading || isGettingFeedback,\n          title: `清除與 ${selectedCharacter.name} 關於目標 \"${goal}\" 的聊天記錄`,\n          children: [\" \", /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"bi bi-trash3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 246\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 73\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(Col, {\n        xs: 12,\n        className: \"mt-2\",\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"danger\",\n          onClose: () => setError(null),\n          dismissible: true,\n          className: \"py-1 px-2 small mb-0\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 51\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 21\n      }, this), (!selectedCharacter || !goal.trim()) && messages.length === 0 && !error && /*#__PURE__*/_jsxDEV(Col, {\n        xs: 12,\n        className: \"mt-2\",\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"info\",\n          className: \"text-center small p-2 mb-0\",\n          children: \" \\u8ACB\\u5148\\u9078\\u64C7\\u89D2\\u8272\\u4E26\\u8A2D\\u5B9A\\u76EE\\u6A19\\uFF0C\\u7136\\u5F8C\\u958B\\u59CB\\u5C0D\\u8A71\\uFF01 \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 117\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 87\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      className: \"chat-display-row m-0\",\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        className: \"p-0\",\n        children: [\" \", /*#__PURE__*/_jsxDEV(ChatDisplay, {\n          messages: messages,\n          isLoading: isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 31\n        }, this), \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Row, {\n      className: \"message-input-row m-0\",\n      children: /*#__PURE__*/_jsxDEV(Col, {\n        children: [\" \", /*#__PURE__*/_jsxDEV(MessageInput, {\n          currentMessage: currentMessage,\n          onMessageChange: setCurrentMessage,\n          onSendMessage: handleSendMessage,\n          onGetFeedback: handleGetFeedback,\n          isLoading: isLoading,\n          isGettingFeedback: isGettingFeedback,\n          disabled: !selectedCharacter || !goal.trim() || isLoading || isGettingFeedback\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 15\n        }, this), \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n}\n_s(TrainingRoom, \"oqi9V6Tq0pk0T9QnlQqqTYQDW9E=\");\n_c = TrainingRoom;\nexport default TrainingRoom;\nvar _c;\n$RefreshReg$(_c, \"TrainingRoom\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","Form","InputGroup","Container","Row","Col","Spinner","Alert","Button","Dropdown","ChatDisplay","MessageInput","sendMessageToOllama","getFeedbackFromOllama","jsxDEV","_jsxDEV","CHAT_HISTORY_PREFIX","FEEDBACK_STORAGE_KEY","TrainingRoom","characters","selectedCharacter","onSelectCharacter","setActiveView","_s","goal","setGoal","messages","setMessages","currentMessage","setCurrentMessage","isLoading","setIsLoading","isGettingFeedback","setIsGettingFeedback","error","setError","currentGoalRef","getStorageKey","trim","goalKey","substring","replace","id","current","storageKey","savedHistory","localStorage","getItem","JSON","parse","e","console","length","setItem","stringify","removeItem","log","handleClearChat","characterName","name","currentGoal","characterId","window","confirm","savedFeedback","allFeedback","Array","isArray","updatedFeedbackHistory","filter","fb","alert","handleSendMessage","newUserMessage","Date","now","sender","text","currentInput","prevMessages","historyForOllama","map","msg","role","content","requestHistory","chatModel","process","env","REACT_APP_OLLAMA_CHAT_MODEL","aiResponseText","newAiMessage","err","errorMsg","message","errorAiMessage","parseFeedback","feedbackText","summary","scores","clarity","empathy","confidence","appropriateness","goalAchievement","summaryMatch","summaryOnlyMatch","scoresTextMatch","match","warn","scoreLines","split","forEach","line","parts","key","toLowerCase","value","Object","prototype","hasOwnProperty","call","score","parseInt","isNaN","Math","max","min","handleGetFeedback","m","feedbackRequestMessage","_scores$clarity","_scores$empathy","_scores$confidence","_scores$appropriatene","_scores$goalAchieveme","historyForFeedback","userMessagesForContext","slice","feedbackModel","REACT_APP_OLLAMA_FEEDBACK_MODEL","feedbackRawText","feedbackMessage","isFeedback","newFeedbackEntry","timestamp","userMessagesContext","rawFeedback","existingFeedback","errorFeedbackMessage","fluid","className","children","md","Text","fileName","_jsxFileName","lineNumber","columnNumber","Control","type","placeholder","onChange","target","disabled","Toggle","variant","size","style","minWidth","textAlign","Menu","maxHeight","overflowY","character","Item","active","onClick","Divider","title","xs","onClose","dismissible","onMessageChange","onSendMessage","onGetFeedback","_c","$RefreshReg$"],"sources":["C:/Users/Paul2/Downloads/front-end-main (5)/front-end-main/src/components/TrainingRoom/TrainingRoom.js"],"sourcesContent":["// src/components/TrainingRoom/TrainingRoom.js (包含同步刪除回饋、記錄用戶上下文)\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { Form, InputGroup, Container, Row, Col, Spinner, Alert, Button, Dropdown } from 'react-bootstrap';\nimport ChatDisplay from './ChatDisplay';\nimport MessageInput from './MessageInput';\nimport { sendMessageToOllama, getFeedbackFromOllama } from '../../services/ollamaService'; // 確保路徑正確\nimport '../../styles/TrainingRoom.css'; // 確保路徑正確\n\nconst CHAT_HISTORY_PREFIX = 'wingchat_history_';\nconst FEEDBACK_STORAGE_KEY = 'wingchat_feedback';\n\nfunction TrainingRoom({ characters, selectedCharacter, onSelectCharacter, setActiveView }) {\n  const [goal, setGoal] = useState('');\n  const [messages, setMessages] = useState([]);\n  const [currentMessage, setCurrentMessage] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [isGettingFeedback, setIsGettingFeedback] = useState(false);\n  const [error, setError] = useState(null);\n  const currentGoalRef = useRef(goal);\n\n  const getStorageKey = useCallback(() => { if (!selectedCharacter || !goal.trim()) return null; const goalKey = goal.trim().substring(0, 50).replace(/[^a-zA-Z0-9-_]/g, '_'); return `${CHAT_HISTORY_PREFIX}${selectedCharacter.id}_${goalKey}`; }, [selectedCharacter, goal]);\n  useEffect(() => { currentGoalRef.current = goal; const storageKey = getStorageKey(); if (storageKey) { const savedHistory = localStorage.getItem(storageKey); if (savedHistory) { try { setMessages(JSON.parse(savedHistory)); } catch (e) { console.error(\"Parsing chat history failed\", e); setMessages([]); } } else { setMessages([]); } } else if (selectedCharacter) { setMessages([]); } setError(null); }, [selectedCharacter, goal, getStorageKey]);\n  useEffect(() => { const storageKey = getStorageKey(); if (storageKey && messages.length > 0) { localStorage.setItem(storageKey, JSON.stringify(messages)); } else if (storageKey && messages.length === 0 && localStorage.getItem(storageKey)) { localStorage.removeItem(storageKey); console.log(`Removed chat history from localStorage on clear: ${storageKey}`); } }, [messages, getStorageKey]);\n\n  // 清除聊天記錄並同步刪除相關回饋\n  const handleClearChat = () => {\n      if (!selectedCharacter || !goal.trim()) return;\n      const characterName = selectedCharacter.name; const currentGoal = goal.trim(); const characterId = selectedCharacter.id;\n      if (window.confirm(`確定要清除與 ${characterName} 關於目標「${currentGoal}」的所有聊天記錄嗎？\\n\\n⚠️ 這將同時刪除所有與此對話相關的回饋記錄！`)) {\n          setMessages([]); // 清除狀態，觸發 useEffect 移除聊天記錄\n          try {\n              const savedFeedback = localStorage.getItem(FEEDBACK_STORAGE_KEY); let allFeedback = [];\n              if (savedFeedback) { allFeedback = JSON.parse(savedFeedback); if (!Array.isArray(allFeedback)) allFeedback = []; }\n              const updatedFeedbackHistory = allFeedback.filter(fb => !(fb.characterId === characterId && fb.goal === currentGoal));\n              localStorage.setItem(FEEDBACK_STORAGE_KEY, JSON.stringify(updatedFeedbackHistory));\n              console.log(`Removed ${allFeedback.length - updatedFeedbackHistory.length} feedback records for characterId=${characterId} and goal=${currentGoal}`);\n          } catch (e) { console.error(\"清除相關回饋記錄時出錯:\", e); alert(\"清除相關回饋記錄時發生錯誤。\"); }\n      }\n  }\n\n  // 發送訊息\n  const handleSendMessage = async () => { if (!currentMessage.trim() || !selectedCharacter) return; if (!goal.trim()) { setError(\"請先設定本次聊天的目標！\"); return; } if (isLoading || isGettingFeedback) return; const newUserMessage = { id: Date.now(), sender: 'user', text: currentMessage }; const currentInput = currentMessage; setMessages(prevMessages => [...prevMessages, newUserMessage]); setCurrentMessage(''); setIsLoading(true); setError(null); try { const historyForOllama = messages.map(msg => ({ role: msg.sender === 'user' ? 'user' : 'assistant', content: msg.text })); const requestHistory = [...historyForOllama, { role: 'user', content: currentInput }]; const chatModel = process.env.REACT_APP_OLLAMA_CHAT_MODEL || 'llama3.2:latest'; const aiResponseText = await sendMessageToOllama(goal, requestHistory, selectedCharacter, chatModel); const newAiMessage = { id: Date.now() + 1, sender: 'ai', text: aiResponseText }; setMessages(prevMessages => [...prevMessages, newAiMessage]); } catch (err) { console.error(\"Error contacting Ollama:\", err); const errorMsg = err.message || \"與 AI 通訊時發生錯誤。\"; setError(errorMsg); const errorAiMessage = { id: Date.now() + 1, sender: 'ai', text: `🤖 抱歉，處理時遇到問題：${errorMsg}` }; setMessages(prevMessages => [...prevMessages, errorAiMessage]); } finally { setIsLoading(false); } };\n\n  // 回饋解析\n  const parseFeedback = (feedbackText) => { let summary = \"無法解析回饋摘要。\"; let scores = { clarity: null, empathy: null, confidence: null, appropriateness: null, goalAchievement: null }; let summaryMatch = null; let summaryOnlyMatch = null; let scoresTextMatch = null; try { summaryMatch = feedbackText.match(/\\[Feedback Summary\\]\\s*([\\s\\S]*?)\\s*\\[Scores\\]/); if (summaryMatch && summaryMatch[1]) { summary = summaryMatch[1].trim(); } else { summaryOnlyMatch = feedbackText.match(/\\[Feedback Summary\\]\\s*([\\s\\S]*)/); if (summaryOnlyMatch && summaryOnlyMatch[1]) { summary = summaryOnlyMatch[1].trim(); console.warn(\"Only found summary...\"); } else { console.warn(\"Could not find [Feedback Summary] section.\"); summary = feedbackText; } } scoresTextMatch = feedbackText.match(/\\[Scores\\]\\s*([\\s\\S]*)/); if (scoresTextMatch && scoresTextMatch[1]) { const scoreLines = scoresTextMatch[1].trim().split('\\n'); scoreLines.forEach(line => { const parts = line.split(':'); if (parts.length === 2) { let key = parts[0].trim().toLowerCase().replace(/\\s+/g, ''); if (key === 'goalachievement') key = 'goalAchievement'; const value = parts[1].trim(); if (Object.prototype.hasOwnProperty.call(scores, key)) { if (value.toLowerCase() === 'n/a') { scores[key] = null; } else { const score = parseInt(value, 10); if (!isNaN(score)) { scores[key] = Math.max(0, Math.min(100, score)); } else { console.warn(`Invalid score value \"${value}\" for key \"${key}\"`); scores[key] = null; } } } else { console.warn(`Unexpected score key \"${key}\" found.`); } } }); } else if (!summaryOnlyMatch && summaryMatch === null){ console.warn(\"Could not find [Scores] section...\"); } } catch (e) { console.error(\"Error parsing feedback text:\", e); summary = feedbackText; scores = { clarity: null, empathy: null, confidence: null, appropriateness: null, goalAchievement: null }; } console.log(\"Parsed Feedback:\", { summary, scores }); return { summary, scores }; };\n\n  // 獲取回饋並記錄上下文\n  const handleGetFeedback = async () => {\n      if (!selectedCharacter || !goal.trim() || messages.filter(m => m.sender === 'user').length === 0) { alert(\"請先設定目標、選擇角色並進行至少一輪對話 (包含你的發言)，才能請求回饋。\"); return; }\n      if (isLoading || isGettingFeedback) return;\n      setIsGettingFeedback(true); setError(null); const feedbackRequestMessage = { id: Date.now(), sender: 'system', text: '⏳ 正在向 AI 請求對話回饋...' }; setMessages(prevMessages => [...prevMessages, feedbackRequestMessage]);\n      try {\n          const historyForFeedback = messages.filter(msg => msg.sender !== 'system').map(msg => ({ role: msg.sender === 'user' ? 'user' : 'assistant', content: msg.text }));\n          // --- 獲取用戶訊息上下文 ---\n          const userMessagesForContext = messages.filter(msg => msg.sender === 'user').slice(-3).map(msg => msg.text);\n          const feedbackModel = process.env.REACT_APP_OLLAMA_FEEDBACK_MODEL || process.env.REACT_APP_OLLAMA_CHAT_MODEL || 'llama3.2:latest';\n          const feedbackRawText = await getFeedbackFromOllama(goal, historyForFeedback, selectedCharacter, feedbackModel);\n          const { summary, scores } = parseFeedback(feedbackRawText);\n          // 聊天框中的回饋訊息（不顯示上下文）\n          const feedbackMessage = { id: Date.now() + 1, sender: 'ai', isFeedback: true, text: `💡 **本次對話回饋 (${goal})**\\n\\n**摘要:**\\n${summary}\\n\\n**評分 (0-100):**\\n- 清晰度: ${scores.clarity ?? 'N/A'}\\n- 同理心: ${scores.empathy ?? 'N/A'}\\n- 自信: ${scores.confidence ?? 'N/A'}\\n- 適當性: ${scores.appropriateness ?? 'N/A'}\\n- 目標達成: ${scores.goalAchievement ?? 'N/A'}` };\n          // 存儲到 localStorage 的數據（包含上下文）\n          const newFeedbackEntry = { timestamp: Date.now(), goal: goal, characterId: selectedCharacter.id, characterName: selectedCharacter.name, scores: scores, summary: summary, userMessagesContext: userMessagesForContext, rawFeedback: feedbackRawText };\n          const existingFeedback = JSON.parse(localStorage.getItem(FEEDBACK_STORAGE_KEY) || '[]');\n          localStorage.setItem(FEEDBACK_STORAGE_KEY, JSON.stringify([...existingFeedback, newFeedbackEntry]));\n          setMessages(prevMessages => [...prevMessages.filter(msg => msg.id !== feedbackRequestMessage.id), feedbackMessage]);\n      } catch (err) { console.error(\"Error getting or parsing feedback from Ollama:\", err); const errorMsg = err.message || \"無法獲取或處理 AI 回饋。\"; setError(errorMsg); const errorFeedbackMessage = { id: Date.now() + 1, sender: 'ai', text: `🤖 抱歉，獲取回饋時遇到問題：${errorMsg}` }; setMessages(prevMessages => [...prevMessages.filter(msg => msg.id !== feedbackRequestMessage.id), errorFeedbackMessage]); }\n      finally { setIsGettingFeedback(false); }\n  };\n\n  return (\n    <Container fluid className=\"training-room-container p-0\">\n      {/* 頂部欄 */}\n      <Row className=\"goal-input-row m-0 align-items-center\">\n        <Col md={7} className=\"mb-2 mb-md-0\">\n          <InputGroup>\n            <InputGroup.Text>🎯</InputGroup.Text>\n            <Form.Control type=\"text\" placeholder=\"輸入本次社交訓練目標...\" value={goal} onChange={(e) => setGoal(e.target.value)} disabled={isLoading || isGettingFeedback} aria-label=\"聊天目標\"/>\n          </InputGroup>\n        </Col>\n        <Col md={5} className=\"d-flex align-items-center justify-content-md-end\">\n          {characters && characters.length > 0 ? (\n            <Dropdown className=\"me-3\" id=\"character-selector-dropdown\">\n              <Dropdown.Toggle variant=\"outline-secondary\" size=\"sm\" id=\"dropdown-character-select-button\" disabled={isLoading || isGettingFeedback} style={{minWidth: '120px', textAlign: 'left'}}>\n                與: {selectedCharacter ? <strong className=\"text-primary\">{selectedCharacter.name}</strong> : '選擇角色'}\n              </Dropdown.Toggle>\n              <Dropdown.Menu style={{maxHeight: '300px', overflowY: 'auto'}}>\n                {characters.map(character => ( <Dropdown.Item key={character.id} active={selectedCharacter?.id === character.id} onClick={() => onSelectCharacter(character)} disabled={selectedCharacter?.id === character.id}> {character.name} </Dropdown.Item> ))}\n                 <Dropdown.Divider />\n                 <Dropdown.Item onClick={() => setActiveView && setActiveView('characters')}> <small className=\"text-muted\"> <i className=\"bi bi-gear me-1\"></i> 管理角色... </small> </Dropdown.Item>\n              </Dropdown.Menu>\n            </Dropdown>\n           ) : ( <span className=\"text-danger me-3 small\">請先至角色館新增角色</span> )}\n          {selectedCharacter && goal.trim() && messages.length > 0 && ( <Button variant=\"outline-danger\" size=\"sm\" onClick={handleClearChat} disabled={isLoading || isGettingFeedback} title={`清除與 ${selectedCharacter.name} 關於目標 \"${goal}\" 的聊天記錄`}> <i className=\"bi bi-trash3\"></i> </Button> )}\n        </Col>\n        {error && ( <Col xs={12} className=\"mt-2\"><Alert variant=\"danger\" onClose={() => setError(null)} dismissible className=\"py-1 px-2 small mb-0\">{error}</Alert></Col> )}\n        {(!selectedCharacter || !goal.trim()) && messages.length === 0 && !error && ( <Col xs={12} className=\"mt-2\"><Alert variant=\"info\" className=\"text-center small p-2 mb-0\"> 請先選擇角色並設定目標，然後開始對話！ </Alert></Col> )}\n      </Row>\n\n      {/* 聊天顯示區域 */}\n      <Row className=\"chat-display-row m-0\">\n        <Col className=\"p-0\"> <ChatDisplay messages={messages} isLoading={isLoading} /> </Col>\n      </Row>\n\n      {/* 訊息輸入區域 */}\n      <Row className=\"message-input-row m-0\">\n        <Col> <MessageInput currentMessage={currentMessage} onMessageChange={setCurrentMessage} onSendMessage={handleSendMessage} onGetFeedback={handleGetFeedback} isLoading={isLoading} isGettingFeedback={isGettingFeedback} disabled={!selectedCharacter || !goal.trim() || isLoading || isGettingFeedback}/> </Col>\n      </Row>\n    </Container>\n  );\n}\nexport default TrainingRoom;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}