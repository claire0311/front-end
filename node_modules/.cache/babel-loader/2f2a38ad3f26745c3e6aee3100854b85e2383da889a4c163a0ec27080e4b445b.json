{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Paul2\\\\Downloads\\\\front-end-main (5)\\\\front-end-main\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// src/App.js (修改部分)\nimport React, { useState, useEffect } from 'react';\nimport { Container } from 'react-bootstrap';\nimport AppNavbar from './components/common/AppNavbar';\nimport TrainingRoom from './components/TrainingRoom/TrainingRoom';\nimport CharacterHall from './components/CharacterHall/CharacterHall';\nimport FeedbackWall from './components/FeedbackWall/FeedbackWall';\nimport './styles/App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CHARACTERS_STORAGE_KEY = 'wingchat_characters';\nfunction App() {\n  _s();\n  const [activeView, setActiveView] = useState('training');\n  const [characters, setCharacters] = useState(() => {\n    const savedCharacters = localStorage.getItem(CHARACTERS_STORAGE_KEY);\n    if (savedCharacters) {\n      try {\n        const parsed = JSON.parse(savedCharacters);\n        // 確保至少有一個預設角色\n        if (Array.isArray(parsed) && parsed.length > 0) {\n          // 確保預設角色存在且在第一位 (如果需要)\n          if (!parsed.find(c => c.id === 'default')) {\n            parsed.unshift({\n              id: 'default',\n              name: '預設助手',\n              description: '我是 WingChat，一個友善且樂於助人的 AI 社交教練。'\n            });\n          }\n          return parsed;\n        }\n      } catch (e) {\n        console.error(\"Failed to parse characters from localStorage\", e);\n      }\n    }\n    // 如果加載失敗或為空，返回包含預設角色的陣列\n    return [{\n      id: 'default',\n      name: '預設助手',\n      description: '我是 WingChat，一個友善且樂於助人的 AI 社交教練。'\n    }];\n  });\n\n  // 確保 selectedCharacter 有一個有效的初始值\n  const [selectedCharacter, setSelectedCharacter] = useState(() => {\n    const initialCharacter = characters.find(c => c.id === 'default') || (characters.length > 0 ? characters[0] : null);\n    return initialCharacter;\n  });\n  useEffect(() => {\n    localStorage.setItem(CHARACTERS_STORAGE_KEY, JSON.stringify(characters));\n  }, [characters]);\n\n  // --- 新增：處理來自 TrainingRoom 的角色變更 ---\n  const handleCharacterChange = characterId => {\n    const newSelectedCharacter = characters.find(c => c.id === characterId);\n    if (newSelectedCharacter) {\n      setSelectedCharacter(newSelectedCharacter);\n    }\n  };\n  // --- 結束新增 ---\n\n  const handleUpdateCharacters = newCharacters => {\n    setCharacters(newCharacters);\n    if (selectedCharacter && !newCharacters.find(c => c.id === selectedCharacter.id)) {\n      setSelectedCharacter(newCharacters.length > 0 ? newCharacters[0] : null);\n    } else if (!selectedCharacter && newCharacters.length > 0) {\n      setSelectedCharacter(newCharacters[0]);\n    }\n  };\n  const handleSelectCharacter = character => {\n    setSelectedCharacter(character);\n    setActiveView('training');\n  };\n  const renderView = () => {\n    switch (activeView) {\n      case 'characters':\n        return /*#__PURE__*/_jsxDEV(CharacterHall, {\n          characters: characters,\n          onUpdateCharacters: handleUpdateCharacters,\n          onSelectCharacter: handleSelectCharacter\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 16\n        }, this);\n      case 'feedback':\n        return /*#__PURE__*/_jsxDEV(FeedbackWall, {\n          chatHistory: []\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 16\n        }, this);\n      case 'training':\n      default:\n        return /*#__PURE__*/_jsxDEV(TrainingRoom\n        // --- 傳遞必要的 props ---\n        , {\n          characters: characters // <--- 傳遞角色列表\n          ,\n          selectedCharacter: selectedCharacter,\n          onCharacterChange: handleCharacterChange // <--- 傳遞更新函數\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 16\n        }, this);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app-container\",\n    children: [/*#__PURE__*/_jsxDEV(AppNavbar, {\n      onSelectView: setActiveView,\n      currentView: activeView\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      fluid: true,\n      className: \"main-content mt-3\",\n      children: renderView()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"SR5U9HkBTpLX4nN4DPTfAlRpv2k=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","Container","AppNavbar","TrainingRoom","CharacterHall","FeedbackWall","jsxDEV","_jsxDEV","CHARACTERS_STORAGE_KEY","App","_s","activeView","setActiveView","characters","setCharacters","savedCharacters","localStorage","getItem","parsed","JSON","parse","Array","isArray","length","find","c","id","unshift","name","description","e","console","error","selectedCharacter","setSelectedCharacter","initialCharacter","setItem","stringify","handleCharacterChange","characterId","newSelectedCharacter","handleUpdateCharacters","newCharacters","handleSelectCharacter","character","renderView","onUpdateCharacters","onSelectCharacter","fileName","_jsxFileName","lineNumber","columnNumber","chatHistory","onCharacterChange","className","children","onSelectView","currentView","fluid","_c","$RefreshReg$"],"sources":["C:/Users/Paul2/Downloads/front-end-main (5)/front-end-main/src/App.js"],"sourcesContent":["// src/App.js (修改部分)\nimport React, { useState, useEffect } from 'react';\nimport { Container } from 'react-bootstrap';\nimport AppNavbar from './components/common/AppNavbar';\nimport TrainingRoom from './components/TrainingRoom/TrainingRoom';\nimport CharacterHall from './components/CharacterHall/CharacterHall';\nimport FeedbackWall from './components/FeedbackWall/FeedbackWall';\nimport './styles/App.css';\n\nconst CHARACTERS_STORAGE_KEY = 'wingchat_characters';\n\nfunction App() {\n  const [activeView, setActiveView] = useState('training');\n  const [characters, setCharacters] = useState(() => {\n    const savedCharacters = localStorage.getItem(CHARACTERS_STORAGE_KEY);\n    if (savedCharacters) {\n      try {\n        const parsed = JSON.parse(savedCharacters);\n        // 確保至少有一個預設角色\n        if (Array.isArray(parsed) && parsed.length > 0) {\n            // 確保預設角色存在且在第一位 (如果需要)\n             if (!parsed.find(c => c.id === 'default')) {\n                 parsed.unshift({ id: 'default', name: '預設助手', description: '我是 WingChat，一個友善且樂於助人的 AI 社交教練。' });\n             }\n            return parsed;\n        }\n      } catch (e) {\n        console.error(\"Failed to parse characters from localStorage\", e);\n      }\n    }\n    // 如果加載失敗或為空，返回包含預設角色的陣列\n    return [{ id: 'default', name: '預設助手', description: '我是 WingChat，一個友善且樂於助人的 AI 社交教練。' }];\n  });\n\n  // 確保 selectedCharacter 有一個有效的初始值\n  const [selectedCharacter, setSelectedCharacter] = useState(() => {\n      const initialCharacter = characters.find(c => c.id === 'default') || (characters.length > 0 ? characters[0] : null);\n      return initialCharacter;\n  });\n\n  useEffect(() => {\n    localStorage.setItem(CHARACTERS_STORAGE_KEY, JSON.stringify(characters));\n  }, [characters]);\n\n  // --- 新增：處理來自 TrainingRoom 的角色變更 ---\n  const handleCharacterChange = (characterId) => {\n      const newSelectedCharacter = characters.find(c => c.id === characterId);\n      if (newSelectedCharacter) {\n          setSelectedCharacter(newSelectedCharacter);\n      }\n  };\n  // --- 結束新增 ---\n\n  const handleUpdateCharacters = (newCharacters) => {\n    setCharacters(newCharacters);\n    if (selectedCharacter && !newCharacters.find(c => c.id === selectedCharacter.id)) {\n      setSelectedCharacter(newCharacters.length > 0 ? newCharacters[0] : null);\n    } else if (!selectedCharacter && newCharacters.length > 0) {\n        setSelectedCharacter(newCharacters[0]);\n    }\n  };\n\n  const handleSelectCharacter = (character) => {\n    setSelectedCharacter(character);\n    setActiveView('training');\n  };\n\n  const renderView = () => {\n    switch (activeView) {\n      case 'characters':\n        return <CharacterHall\n                  characters={characters}\n                  onUpdateCharacters={handleUpdateCharacters}\n                  onSelectCharacter={handleSelectCharacter}\n                />;\n      case 'feedback':\n        return <FeedbackWall chatHistory={[]} />;\n      case 'training':\n      default:\n        return <TrainingRoom\n                  // --- 傳遞必要的 props ---\n                  characters={characters} // <--- 傳遞角色列表\n                  selectedCharacter={selectedCharacter}\n                  onCharacterChange={handleCharacterChange} // <--- 傳遞更新函數\n               />;\n    }\n  };\n\n  return (\n    <div className=\"app-container\">\n      <AppNavbar onSelectView={setActiveView} currentView={activeView} />\n      <Container fluid className=\"main-content mt-3\">\n        {renderView()}\n      </Container>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}