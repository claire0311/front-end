{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Paul2\\\\Downloads\\\\front-end-main (5)\\\\front-end-main\\\\src\\\\components\\\\CharacterHall\\\\CharacterEvalModal.js\",\n  _s = $RefreshSig$();\n// src/components/CharacterHall/CharacterEvalModal.js (添加刪除、篩選器收起、圖表彈窗)\n\nimport React, { useState, useEffect, useMemo } from 'react';\nimport { Modal, Button, Alert, ListGroup, Badge, Collapse, Form, InputGroup, Row, Col } from 'react-bootstrap';\n// import FeedbackChart from '../FeedbackWall/FeedbackChart'; // 不再直接使用\nimport ChartModal from '../FeedbackWall/ChartModal'; // <<<--- 導入 ChartModal\nimport './CharacterHall.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst FEEDBACK_STORAGE_KEY = 'wingchat_feedback';\nconst ALL_METRICS = [{\n  key: 'clarity',\n  label: '清晰度'\n} /* ... 其他指標 */];\n\n// --- 接收 onDeleteFeedback prop ---\nfunction CharacterEvalModal({\n  show,\n  onHide,\n  character,\n  onDeleteFeedback\n}) {\n  _s();\n  const [originalCharacterFeedback, setOriginalCharacterFeedback] = useState([]);\n  const [filteredCharacterFeedback, setFilteredCharacterFeedback] = useState([]);\n  const [goalSearchModal, setGoalSearchModal] = useState('');\n  const [showEvalFilters, setShowEvalFilters] = useState(false); // 篩選器默認收起\n  // const [selectedMetricsModal, setSelectedMetricsModal] = useState(ALL_METRICS.map(m => m.key)); // 移到 ChartModal\n  const [showEvalChartModal, setShowEvalChartModal] = useState(false); // <<<--- 控制圖表 Modal\n\n  useEffect(() => {/* ... (加載數據邏輯不變) ... */}, [show, character]);\n  useEffect(() => {/* ... (篩選邏輯不變) ... */}, [originalCharacterFeedback, goalSearchModal, show]);\n\n  // getScore 函數\n  const getScore = score => score === null || score === undefined ? 0 : score;\n\n  // --- 清除 Modal 內的篩選 ---\n  const clearModalFilters = () => {\n    setGoalSearchModal('');\n    // 如果 ChartModal 還有其他篩選，也需重置，但指標選擇在 ChartModal 內部處理\n  };\n  return /*#__PURE__*/_jsxDEV(Modal, {\n    show: show,\n    onHide: onHide,\n    centered: true,\n    size: \"lg\",\n    dialogClassName: \"character-eval-modal-dialog\",\n    children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n      closeButton: true,\n      children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n        children: [\"\\u8207 \\\"\", character === null || character === void 0 ? void 0 : character.name, \"\\\" \\u7684\\u5C0D\\u8A71\\u8A55\\u4F30\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n      className: \"d-flex flex-column p-0 character-eval-modal-body\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"character-eval-filters bg-light p-3 border-bottom\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex justify-content-between align-items-center mb-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            className: \"mb-0 text-muted small\",\n            children: \"\\u641C\\u5C0B\\u5C0D\\u8A71\\u76EE\\u6A19\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 43,\n            columnNumber: 14\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"link\",\n            size: \"sm\",\n            onClick: () => setShowEvalFilters(!showEvalFilters),\n            \"aria-controls\": \"collapse-eval-filters\",\n            \"aria-expanded\": showEvalFilters,\n            className: \"p-0 text-secondary\",\n            children: [showEvalFilters ? '收起' : '展開', \" \", /*#__PURE__*/_jsxDEV(\"i\", {\n              className: `bi bi-chevron-${showEvalFilters ? 'up' : 'down'}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 45,\n              columnNumber: 48\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 44,\n            columnNumber: 14\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 12\n        }, this), /*#__PURE__*/_jsxDEV(Collapse, {\n          in: showEvalFilters,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"collapse-eval-filters\",\n            children: [/*#__PURE__*/_jsxDEV(InputGroup, {\n              size: \"sm\",\n              className: \"mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(InputGroup.Text, {\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-search\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 51,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 51,\n                columnNumber: 20\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                placeholder: \"\\u641C\\u5C0B\\u6B64\\u89D2\\u8272\\u7684\\u5C0D\\u8A71\\u76EE\\u6A19...\",\n                value: goalSearchModal,\n                onChange: e => setGoalSearchModal(e.target.value)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 52,\n                columnNumber: 20\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 50,\n              columnNumber: 17\n            }, this), goalSearchModal &&\n            /*#__PURE__*/\n            // 只有在有搜尋條件時才顯示清除按鈕\n            _jsxDEV(Button, {\n              variant: \"outline-secondary\",\n              size: \"sm\",\n              onClick: clearModalFilters,\n              className: \"w-100\",\n              children: \"\\u6E05\\u9664\\u76EE\\u6A19\\u641C\\u5C0B\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 55,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 14\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 48,\n          columnNumber: 12\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 10\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"character-eval-content flex-grow-1 overflow-auto p-3\",\n        children: originalCharacterFeedback.length > 0 ? filteredCharacterFeedback.length > 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-end mb-3\",\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              variant: \"outline-primary\",\n              size: \"sm\",\n              onClick: () => setShowEvalChartModal(true),\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"bi bi-graph-up me-1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 72,\n                columnNumber: 24\n              }, this), \" \\u67E5\\u770B\\u8DA8\\u52E2\\u5716\\u8868\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 71,\n              columnNumber: 20\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            className: \"mb-3\",\n            children: [\"\\u8A73\\u7D30\\u56DE\\u994B\\u8A18\\u9304 (\", filteredCharacterFeedback.length, \" \\u7B46)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ListGroup, {\n            variant: \"flush\",\n            children: [...filteredCharacterFeedback].map(fb =>\n            /*#__PURE__*/\n            // 使用篩選後數據\n            _jsxDEV(ListGroup.Item, {\n              className: \"px-0 d-flex justify-content-between align-items-start\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex-grow-1 me-2\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex justify-content-between align-items-center mb-2\",\n                  children: [\" \", /*#__PURE__*/_jsxDEV(\"small\", {\n                    className: \"text-muted\",\n                    children: [\" \", new Date(fb.timestamp).toLocaleString('zh-TW', {\n                      dateStyle: 'short',\n                      timeStyle: 'short'\n                    }), \" \"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 83,\n                    columnNumber: 97\n                  }, this), \" \", /*#__PURE__*/_jsxDEV(Badge, {\n                    bg: \"light\",\n                    text: \"dark\",\n                    children: [\"\\u76EE\\u6A19: \", fb.goal || '未指定']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 83,\n                    columnNumber: 230\n                  }, this), \" \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 83,\n                  columnNumber: 24\n                }, this), \" \", /*#__PURE__*/_jsxDEV(\"h6\", {\n                  children: \"AI \\u7E3D\\u7D50:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 83,\n                  columnNumber: 298\n                }, this), \" \", /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    whiteSpace: 'pre-wrap',\n                    fontSize: '0.95em'\n                  },\n                  children: fb.summary || '-'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 83,\n                  columnNumber: 314\n                }, this), \" \", fb.scores && Object.values(fb.scores).some(s => s !== null) && /*#__PURE__*/_jsxDEV(_Fragment, {\n                  children: [\" \", /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"small mb-1\",\n                    children: \"\\u8A55\\u5206:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 83,\n                    columnNumber: 465\n                  }, this), \" \", /*#__PURE__*/_jsxDEV(\"ul\", {\n                    className: \"list-inline small mb-0\",\n                    children: [\" \", ALL_METRICS.map(metric => {\n                      var _getScore;\n                      return fb.scores[metric.key] !== null && fb.scores[metric.key] !== undefined && /*#__PURE__*/_jsxDEV(\"li\", {\n                        className: \"list-inline-item me-3\",\n                        children: [\" \", metric.label, \": \", /*#__PURE__*/_jsxDEV(Badge, {\n                          pill: true,\n                          bg: getScore(fb.scores[metric.key]) >= 60 ? \"success\" : getScore(fb.scores[metric.key]) > 0 ? \"warning\" : \"secondary\",\n                          children: [\" \", (_getScore = getScore(fb.scores[metric.key])) !== null && _getScore !== void 0 ? _getScore : 'N/A', \" \"]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 83,\n                          columnNumber: 715\n                        }, this), \" \"]\n                      }, metric.key, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 83,\n                        columnNumber: 643\n                      }, this);\n                    }), \" \"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 83,\n                    columnNumber: 499\n                  }, this), \" \"]\n                }, void 0, true)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"outline-danger\",\n                size: \"sm\",\n                className: \"delete-feedback-btn p-0 flex-shrink-0\" // 確保按鈕不壓縮\n                ,\n                onClick: () => onDeleteFeedback(fb.timestamp) // <<<--- 調用傳入的刪除函數\n                ,\n                title: \"\\u522A\\u9664\\u6B64\\u7B46\\u56DE\\u994B\",\n                style: {\n                  lineHeight: 1,\n                  width: '24px',\n                  height: '24px'\n                } // 調整大小\n                ,\n                children: /*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"bi bi-x\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 94,\n                  columnNumber: 24\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 21\n              }, this)]\n            }, fb.timestamp, true, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"warning\",\n          children: [\"\\u627E\\u4E0D\\u5230\\u7B26\\u5408\\u76EE\\u6A19\\u95DC\\u9375\\u5B57 \\\"\", goalSearchModal, \"\\\" \\u7684\\u8A18\\u9304\\u3002\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 19\n        }, this) : /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"info\",\n          children: \"\\u9084\\u6C92\\u6709\\u8207\\u6B64\\u89D2\\u8272\\u7684\\u5C0D\\u8A71\\u8A55\\u4F30\\u8A18\\u9304\\u3002\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n      children: [\" \", /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"secondary\",\n        onClick: onHide,\n        children: \" \\u95DC\\u9589 \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 22\n      }, this), \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ChartModal, {\n      show: showEvalChartModal,\n      onHide: () => setShowEvalChartModal(false)\n      // 傳遞給圖表 Modal 的數據也應該是篩選過的\n      ,\n      feedbackData: filteredCharacterFeedback\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 8\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this);\n}\n_s(CharacterEvalModal, \"pyAhUBU7imunPp//rBzWljiyVes=\");\n_c = CharacterEvalModal;\nexport default CharacterEvalModal;\nvar _c;\n$RefreshReg$(_c, \"CharacterEvalModal\");","map":{"version":3,"names":["React","useState","useEffect","useMemo","Modal","Button","Alert","ListGroup","Badge","Collapse","Form","InputGroup","Row","Col","ChartModal","jsxDEV","_jsxDEV","Fragment","_Fragment","FEEDBACK_STORAGE_KEY","ALL_METRICS","key","label","CharacterEvalModal","show","onHide","character","onDeleteFeedback","_s","originalCharacterFeedback","setOriginalCharacterFeedback","filteredCharacterFeedback","setFilteredCharacterFeedback","goalSearchModal","setGoalSearchModal","showEvalFilters","setShowEvalFilters","showEvalChartModal","setShowEvalChartModal","getScore","score","undefined","clearModalFilters","centered","size","dialogClassName","children","Header","closeButton","Title","name","fileName","_jsxFileName","lineNumber","columnNumber","Body","className","variant","onClick","in","id","Text","Control","type","placeholder","value","onChange","e","target","length","map","fb","Item","Date","timestamp","toLocaleString","dateStyle","timeStyle","bg","text","goal","style","whiteSpace","fontSize","summary","scores","Object","values","some","s","metric","_getScore","pill","title","lineHeight","width","height","Footer","feedbackData","_c","$RefreshReg$"],"sources":["C:/Users/Paul2/Downloads/front-end-main (5)/front-end-main/src/components/CharacterHall/CharacterEvalModal.js"],"sourcesContent":["// src/components/CharacterHall/CharacterEvalModal.js (添加刪除、篩選器收起、圖表彈窗)\r\n\r\nimport React, { useState, useEffect, useMemo } from 'react';\r\nimport { Modal, Button, Alert, ListGroup, Badge, Collapse, Form, InputGroup, Row, Col } from 'react-bootstrap';\r\n// import FeedbackChart from '../FeedbackWall/FeedbackChart'; // 不再直接使用\r\nimport ChartModal from '../FeedbackWall/ChartModal'; // <<<--- 導入 ChartModal\r\nimport './CharacterHall.css';\r\n\r\nconst FEEDBACK_STORAGE_KEY = 'wingchat_feedback';\r\nconst ALL_METRICS = [ { key: 'clarity', label: '清晰度' }, /* ... 其他指標 */ ];\r\n\r\n// --- 接收 onDeleteFeedback prop ---\r\nfunction CharacterEvalModal({ show, onHide, character, onDeleteFeedback }) {\r\n  const [originalCharacterFeedback, setOriginalCharacterFeedback] = useState([]);\r\n  const [filteredCharacterFeedback, setFilteredCharacterFeedback] = useState([]);\r\n  const [goalSearchModal, setGoalSearchModal] = useState('');\r\n  const [showEvalFilters, setShowEvalFilters] = useState(false); // 篩選器默認收起\r\n  // const [selectedMetricsModal, setSelectedMetricsModal] = useState(ALL_METRICS.map(m => m.key)); // 移到 ChartModal\r\n  const [showEvalChartModal, setShowEvalChartModal] = useState(false); // <<<--- 控制圖表 Modal\r\n\r\n  useEffect(() => { /* ... (加載數據邏輯不變) ... */ }, [show, character]);\r\n  useEffect(() => { /* ... (篩選邏輯不變) ... */ }, [originalCharacterFeedback, goalSearchModal, show]);\r\n\r\n  // getScore 函數\r\n  const getScore = (score) => (score === null || score === undefined ? 0 : score);\r\n\r\n  // --- 清除 Modal 內的篩選 ---\r\n  const clearModalFilters = () => {\r\n      setGoalSearchModal('');\r\n      // 如果 ChartModal 還有其他篩選，也需重置，但指標選擇在 ChartModal 內部處理\r\n  }\r\n\r\n  return (\r\n    <Modal show={show} onHide={onHide} centered size=\"lg\" dialogClassName=\"character-eval-modal-dialog\">\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>與 \"{character?.name}\" 的對話評估</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body className=\"d-flex flex-column p-0 character-eval-modal-body\">\r\n\r\n         {/* --- 可收起的篩選區域 --- */}\r\n         <div className=\"character-eval-filters bg-light p-3 border-bottom\">\r\n           <div className=\"d-flex justify-content-between align-items-center mb-2\">\r\n             <h6 className=\"mb-0 text-muted small\">搜尋對話目標</h6>\r\n             <Button variant=\"link\" size=\"sm\" onClick={() => setShowEvalFilters(!showEvalFilters)} aria-controls=\"collapse-eval-filters\" aria-expanded={showEvalFilters} className=\"p-0 text-secondary\">\r\n               {showEvalFilters ? '收起' : '展開'} <i className={`bi bi-chevron-${showEvalFilters ? 'up' : 'down'}`}></i>\r\n             </Button>\r\n           </div>\r\n           <Collapse in={showEvalFilters}>\r\n             <div id=\"collapse-eval-filters\">\r\n                <InputGroup size=\"sm\" className=\"mb-2\">\r\n                   <InputGroup.Text><i className=\"bi bi-search\"></i></InputGroup.Text>\r\n                   <Form.Control type=\"text\" placeholder=\"搜尋此角色的對話目標...\" value={goalSearchModal} onChange={(e) => setGoalSearchModal(e.target.value)} />\r\n                 </InputGroup>\r\n                 {goalSearchModal && ( // 只有在有搜尋條件時才顯示清除按鈕\r\n                    <Button variant=\"outline-secondary\" size=\"sm\" onClick={clearModalFilters} className=\"w-100\">\r\n                      清除目標搜尋\r\n                    </Button>\r\n                 )}\r\n                 {/* 指標篩選移到 ChartModal 中 */}\r\n             </div>\r\n           </Collapse>\r\n         </div>\r\n\r\n        {/* --- 可滾動的內容區域 (僅列表) --- */}\r\n        <div className=\"character-eval-content flex-grow-1 overflow-auto p-3\">\r\n          {originalCharacterFeedback.length > 0 ? (\r\n            filteredCharacterFeedback.length > 0 ? (\r\n             <>\r\n              {/* --- 添加圖表按鈕 --- */}\r\n              <div className=\"text-end mb-3\">\r\n                   <Button variant=\"outline-primary\" size=\"sm\" onClick={() => setShowEvalChartModal(true)}>\r\n                       <i className=\"bi bi-graph-up me-1\"></i> 查看趨勢圖表\r\n                   </Button>\r\n               </div>\r\n\r\n              {/* 歷史記錄列表 (添加刪除按鈕) */}\r\n              <h5 className=\"mb-3\">詳細回饋記錄 ({filteredCharacterFeedback.length} 筆)</h5>\r\n              <ListGroup variant=\"flush\">\r\n                {[...filteredCharacterFeedback].map(fb => ( // 使用篩選後數據\r\n                  <ListGroup.Item key={fb.timestamp} className=\"px-0 d-flex justify-content-between align-items-start\">\r\n                    {/* 左側內容 */}\r\n                    <div className=\"flex-grow-1 me-2\">\r\n                       <div className=\"d-flex justify-content-between align-items-center mb-2\"> <small className=\"text-muted\"> {new Date(fb.timestamp).toLocaleString('zh-TW', { dateStyle: 'short', timeStyle: 'short' })} </small> <Badge bg=\"light\" text=\"dark\">目標: {fb.goal || '未指定'}</Badge> </div> <h6>AI 總結:</h6> <p style={{ whiteSpace: 'pre-wrap', fontSize: '0.95em' }}>{fb.summary || '-'}</p> {fb.scores && Object.values(fb.scores).some(s => s !== null) && ( <> <p className=\"small mb-1\">評分:</p> <ul className=\"list-inline small mb-0\"> {ALL_METRICS.map(metric => ( (fb.scores[metric.key] !== null && fb.scores[metric.key] !== undefined) && <li key={metric.key} className=\"list-inline-item me-3\"> {metric.label}: <Badge pill bg={getScore(fb.scores[metric.key]) >= 60 ? \"success\" : (getScore(fb.scores[metric.key]) > 0 ? \"warning\" : \"secondary\")}> {getScore(fb.scores[metric.key]) ?? 'N/A'} </Badge> </li> ))} </ul> </> )}\r\n                    </div>\r\n                    {/* 右側刪除按鈕 */}\r\n                    <Button\r\n                       variant=\"outline-danger\"\r\n                       size=\"sm\"\r\n                       className=\"delete-feedback-btn p-0 flex-shrink-0\" // 確保按鈕不壓縮\r\n                       onClick={() => onDeleteFeedback(fb.timestamp)} // <<<--- 調用傳入的刪除函數\r\n                       title=\"刪除此筆回饋\"\r\n                       style={{ lineHeight: 1, width: '24px', height: '24px' }} // 調整大小\r\n                    >\r\n                       <i className=\"bi bi-x\"></i>\r\n                    </Button>\r\n                  </ListGroup.Item>\r\n                ))}\r\n              </ListGroup>\r\n             </>\r\n            ) : ( <Alert variant=\"warning\">找不到符合目標關鍵字 \"{goalSearchModal}\" 的記錄。</Alert> )\r\n          ) : ( <Alert variant=\"info\">還沒有與此角色的對話評估記錄。</Alert> )}\r\n        </div>\r\n      </Modal.Body>\r\n      <Modal.Footer> <Button variant=\"secondary\" onClick={onHide}> 關閉 </Button> </Modal.Footer>\r\n\r\n       {/* --- 圖表 Modal (在 Eval Modal 內部觸發) --- */}\r\n       <ChartModal\r\n          show={showEvalChartModal}\r\n          onHide={() => setShowEvalChartModal(false)}\r\n          // 傳遞給圖表 Modal 的數據也應該是篩選過的\r\n          feedbackData={filteredCharacterFeedback}\r\n        />\r\n\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default CharacterEvalModal;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}